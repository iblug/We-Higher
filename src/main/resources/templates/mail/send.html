<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<div layout:fragment="content">
  <h2>메일 보내기</h2>
  <div class="container">
    <form action="/mail/send" method="post" enctype="multipart/form-data">
      <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
      <table>
        <tr class="form-group">
          <td>보내는 사람</td>
          <td>
            <input type="text" class="form-control" name="from" th:value="${mailsender}" placeholder="이메일 주소를 입력하세요" readonly>
          </td>
        </tr>
        <tr id="box" class="form-group">
          <td>받는 사람</td>
          <td>
            <input type="text" class="form-control" name="address" placeholder="이메일 주소를 입력하세요">
          </td>
          <td>
            <input type="button" class="form-control" value="추가" onclick="add_textbox(this)">
          </td>
        </tr>
        <tr id="box2" class="form-group">
          <td>참조 메일 주소</td>
          <td>
            <input type="text" class="form-control" name="ccAddress" placeholder="참조 수신인을 입력하세요">
          </td>
          <td>
            <input type="button" class="form-control" value="추가" onclick="add_textbox2(this)">
          </td>
        </tr>
        <tr class="form-group">
          <td>제목</td>
          <td>
            <input type="text" class="form-control" name="title" placeholder="제목을 입력하세요">
          </td>
        </tr>
        <tr class="form-group">
          <td>내용</td>
          <td>
            <textarea class="form-control" name="content" placeholder="보낼 내용을 입력하세요"> </textarea>
          </td>
        </tr>
        <tr class="form-group">
          <td>첨부 파일 </td>
          <td>
            <input type="file" name="file" class="file-input" />
          </td>
        </tr>
      </table>
      <button class="btn btn-default">발송</button>
    </form>
  </div>
  </body>
  <script>
    const add_textbox = () => {
      const box = document.getElementById("box");
      const newP = document.createElement("tr");

      newP.innerHTML = "<th>메일 주소</th><td><input type='text' name='address' ><input type='button' value='삭제' onclick='opt_remove(this)'></td>";
      box.parentNode.insertBefore(newP, box.nextSibling);
    }

    const add_textbox2 = () => {
      const box = document.getElementById("box2");
      const newP = document.createElement("tr");

      newP.innerHTML = "<th>참조 메일 주소</th><td><input type='text' name='ccAddress' ><input type='button' value='삭제' onclick='opt_remove2(this)'></td>";
      box.parentNode.insertBefore(newP, box.nextSibling);
    }

    const opt_remove = (obj) => {
      document.getElementById('box').parentElement.removeChild(obj.parentElement.parentElement);
    }
    const opt_remove2 = (obj) => {
      document.getElementById('box2').parentElement.removeChild(obj.parentElement.parentElement);
    }
  </script>
</div>
</html>